<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª - Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body class="auth-body">

    <div class="auth-container">
        <div class="auth-card glass-effect">
            <div class="auth-header">
                <div class="logo-icon" style="background: linear-gradient(135deg, #f44336, #d32f2f);">
                    <i class="fa-solid fa-triangle-exclamation"></i>
                </div>
                <h1 style="color: #f44336;">Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h1>
                <p>âš ï¸ ØªØ­Ø°ÙŠØ±: Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡Ø§!</p>
            </div>

            <div class="auth-form">
                <div
                    style="background: rgba(255,87,34,0.1); border: 2px solid #f44336; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                    <h5 style="color: #f44336; margin-bottom: 10px;">ğŸ—‘ï¸ Ø³ÙŠØªÙ… Ø­Ø°Ù:</h5>
                    <ul style="color: #fff; line-height: 2;">
                        <li>âœ“ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</li>
                        <li>âœ“ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</li>
                        <li>âœ“ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ù† Firestore</li>
                    </ul>
                    <p style="color: #ffeb3b; margin-top: 15px;">
                        <i class="fa-solid fa-info-circle"></i>
                        Ù…Ù„Ø§Ø­Ø¸Ø©: Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡ ÙÙŠ Firebase Authentication Ù„Ù† ÙŠØªÙ… Ø­Ø°ÙÙ‡Ø§ (ÙŠØ¬Ø¨ Ø­Ø°ÙÙ‡Ø§ ÙŠØ¯ÙˆÙŠØ§Ù‹ Ù…Ù† Firebase
                        Console)
                    </p>
                </div>

                <button id="clearAllBtn" class="btn-primary pulse-effect"
                    style="background: linear-gradient(135deg, #f44336, #d32f2f);">
                    <span>ğŸ—‘ï¸ Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span>
                    <i class="fa-solid fa-trash-can"></i>
                </button>

                <div id="status" style="margin-top: 20px; padding: 15px; border-radius: 8px; display: none;"></div>

                <div style="text-align: center; margin-top: 1.5rem;">
                    <a href="dashboard.html" style="color: #a0aec0; text-decoration: none; font-size: 0.9rem;">
                        <i class="fa-solid fa-arrow-right"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { db, collection, getDocs, deleteDoc, doc } from './js/firebase-config.js';

        document.getElementById('clearAllBtn').addEventListener('click', async () => {
            // Double confirm
            const confirm1 = confirm('âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ\n\nÙ‡Ø°Ù‡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡Ø§!');
            if (!confirm1) return;

            const confirm2 = confirm('âš ï¸âš ï¸ ØªØ£ÙƒÙŠØ¯ Ù†Ù‡Ø§Ø¦ÙŠ!\n\nØ³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø·Ù„Ø¨Ø§Øª ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø´ÙƒÙ„ Ù†Ù‡Ø§Ø¦ÙŠ.\n\nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŸ');
            if (!confirm2) return;

            const btn = document.getElementById('clearAllBtn');
            const status = document.getElementById('status');

            btn.disabled = true;
            btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø³Ø­...';
            status.style.display = 'block';
            status.style.background = 'rgba(33,150,243,0.1)';
            status.style.border = '1px solid #2196f3';
            status.style.color = '#fff';
            status.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø³Ø­...';

            try {
                let deletedCount = 0;

                // Delete Products
                status.innerHTML += '<br>ğŸ—‘ï¸ Ø¬Ø§Ø±ÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...';
                const productsSnapshot = await getDocs(collection(db, "products"));
                for (const docSnapshot of productsSnapshot.docs) {
                    await deleteDoc(doc(db, "products", docSnapshot.id));
                    deletedCount++;
                }
                status.innerHTML += `<br>âœ“ ØªÙ… Ø­Ø°Ù ${productsSnapshot.size} Ù…Ù†ØªØ¬`;

                // Delete Orders
                status.innerHTML += '<br>ğŸ—‘ï¸ Ø¬Ø§Ø±ÙŠ Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨Ø§Øª...';
                const ordersSnapshot = await getDocs(collection(db, "orders"));
                for (const docSnapshot of ordersSnapshot.docs) {
                    await deleteDoc(doc(db, "orders", docSnapshot.id));
                    deletedCount++;
                }
                status.innerHTML += `<br>âœ“ ØªÙ… Ø­Ø°Ù ${ordersSnapshot.size} Ø·Ù„Ø¨`;

                // Delete Users (if you have a users collection)
                status.innerHTML += '<br>ğŸ—‘ï¸ Ø¬Ø§Ø±ÙŠ Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†...';
                const usersSnapshot = await getDocs(collection(db, "users"));
                for (const docSnapshot of usersSnapshot.docs) {
                    await deleteDoc(doc(db, "users", docSnapshot.id));
                    deletedCount++;
                }
                status.innerHTML += `<br>âœ“ ØªÙ… Ø­Ø°Ù ${usersSnapshot.size} Ù…Ø³ØªØ®Ø¯Ù…`;

                // Success
                status.style.background = 'rgba(76,175,80,0.1)';
                status.style.border = '1px solid #4caf50';
                status.innerHTML += `<br><br>âœ… <strong>ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!</strong><br>Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${deletedCount} Ø¹Ù†ØµØ±`;

                btn.innerHTML = 'âœ… ØªÙ… Ø§Ù„Ù…Ø³Ø­';
                btn.style.background = '#4caf50';

                setTimeout(() => {
                    window.location.href = 'setup.html';
                }, 2000);

            } catch (error) {
                console.error(error);
                status.style.background = 'rgba(244,67,54,0.1)';
                status.style.border = '1px solid #f44336';
                status.innerHTML = `âŒ <strong>ÙØ´Ù„ ÙÙŠ Ø§Ù„Ù…Ø³Ø­:</strong><br>${error.message}`;

                btn.innerHTML = 'ğŸ—‘ï¸ Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª';
                btn.disabled = false;
            }
        });
    </script>
</body>

</html>